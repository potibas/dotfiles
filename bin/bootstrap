#!/bin/zsh
set -e

# Install Homebrew
if ! type brew > /dev/null 2>/dev/null; then
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

# Install Homebrew formulae and casks
brew bundle

# Sudo without password
sudo sed -i '' 's/^%admin.*/%admin          ALL = (ALL) NOPASSWD:ALL/' /etc/sudoers

# Un-quarantine  applications
sudo xattr -dr com.apple.quarantine "/Applications/Whatsapp.app"
sudo xattr -dr com.apple.quarantine "/Applications/Spotify.app"
sudo xattr -dr com.apple.quarantine "/Applications/Google Chrome.app"
sudo xattr -dr com.apple.quarantine "/Applications/Gnucash.app"
sudo xattr -dr com.apple.quarantine "/Applications/Keybase.app"
sudo xattr -dr com.apple.quarantine "/Applications/Karabiner-Elements.app"
sudo xattr -dr com.apple.quarantine "/Applications/Karabiner-EventViewer.app"
sudo xattr -dr com.apple.quarantine "/Applications/Kitty.app"

# Force en_GB locale for GnuCash
defaults write -app Gnucash AppleLocale 'en_GB.UTF-8'

echo "=== finished bootstrap script, open new terminal session ==="
